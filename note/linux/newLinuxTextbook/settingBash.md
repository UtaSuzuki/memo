# bash の設定

## 目次

- [エイリアス](#alias)

- [bash のオプション](#bashOptions)

- [シェル変数](#shellVariable)

	- [変数の設定](#settingVariable)

	- [PS1 (プロンプト設定)](#PS1)

	- [PATH (コマンド検索パス)](#PATH)

	- [LANG (ロケール)](#LANG)

	- [その他のシェル変数](#otherVariable)

- [環境変数](#environmentVariable)

- [bash の設定ファイル](#bashSettingFiles)

	- [設定ファイルの読み込み](#loadTheBashSettingFile)

	- [コメント](#comment)

## <a id="alias"></a> エイリアス

よく使われるエイリアス

```shell
alias la='ls -a'
alias ll='ls -l'

alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'
```

## <a id="bashOptions"></a> bash のオプション

シェル自身が持つさまざまな機能を利用するためにオプションを指定できる。  
オプションは 1 つ 1 つ機能ごとに「オン / オフ」のいずれかの値を取り、各機能の有効 / 無効を指定できる。

オプションの設定には、`sed` コマンドまたは `shopt` コマンドを使う。

## <a id="shellVariable"></a> シェル変数

bash 内部で使用される変数のこと。  
数値や文字列を保存して、さまざまな値を設定することができる。

bash には特別な意味を持つシェル変数が多数用意されていて、これを設定することでシェルのさまざまな機能のカスタマイズを行える。

詳細は、bash マニュアルの「Shell Varialbes (シェル変数)」を参照。

### <a id="settingVariable"></a> 変数の設定

値にスペースを含む場合には、`'` か `"` で囲む必要がある。

設定した変数を参照するには、変数名の先頭に `$` を付ける。

```shell
# 書式 ("=" の前後にスペースを入れると、変数名がコマンドと見做されエラーになる)
<変数名>=<値>

# var1 という変数に「test variable」という値を設定
var1='test variable'

# var1 の内容を表示
echo $var1
test varialbe
```

### <a id="PS1"></a> PS1 (プロンプト設定)

シェル変数 `PS1` に文字列を設定することで、**設定した文字列がそのままプロンプトになる**。  
PS1 には特別な意味を持つ記号を設定することができ、プロンプト表示の際にそれぞれの意味に置き換わって表示される。

```shell
# プロンプトを「$」から「bash> 」に変更
PS1='bash> '
bash>

# ユーザ名を表示する
bash> PS1='[\u]> '
[yuta]>

# カレントディレクトリを表示する
[yuta]> PS1='[\u] \w \'
[yuta] ~ $
[yuta] ~ cd /usr/local/    # カレントディレクトリを移動すると、、、
[yuta] /usr/local $
```

プロンプトで利用できる記号 :

記号 | 内容
---|---
\d | 「曜日 月 日」という形式の日付
\h | ドメイン名を含まないホスト名 (最初の `.` までの部分)
\H | ドメイン名を含むホスト名
\n | 改行
\t | HH:MM:SS 形式の現在時刻
\u | ユーザ名
\w | カレントディレクトリ
\W | カレントディレクトリの末尾のディレクトリ名
\\| root ユーザの場合は `#`、それ以外のユーザの場合は `$`
\\\\ | `\` そのもの

### <a id="PATH"></a> PATH (コマンド検索パス)

シェル変数 `PATH` には、コマンドを実行する際にシェルがコマンドの実体ファイルを探すディレクトリを指定する。  
シェルがコマンドを探すディレクトリ順に `:` 区切りで連結する。

```shell
echo $PATH
/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/home/yuta/.local/bin:/home/yuta/bin
```

### <a id="LANG"></a> LANG (ロケール)

多くの Linux ディストリビューションでは、インストール時に言語や国、地域などを特定するための識別子であるロケール (Locale) を設定する。  
**表示する言語や日付の書式などは、このロケールを基準にして切り替えられる**。

現在のロケールは `LANG` というシェル変数で指定されている。  
システムがサポートしているロケールは、`locale` コマンドに `-a` オプションで確認できる

```shell
echo $LANG
jp_JP.UTF-8    # 日本語の UTF-8 エンコーディングを示す
```

ロケールを切り替えた場合、bash で表示されるメッセージが指定した言語に切り替わる

```shell
cmd1
-bash: cmd1: コマンドが見つかりませんでした...

LANG=en_US.UTF-8
cmd1
-bash: cmd1: command not found...
```

### <a id="otherVariable"></a> その他のシェル変数

よく使われるシェル変数の例 :

シェル変数名 | 内容
---|---
HISTFILE | コマンドライン履歴を表示するファイル名 (デフォルト : ~/.bash_history)
HISTFILESIZE | 履歴ファイルに保存するコマンドライン履歴の最大行数
HISTSIZE | コマンドライン履歴を保持する最大行数
HOME | ホームディレクトリ (デフォルト : /home/yuta)
SHELL | ログインシェルのパス (デフォルト : /bin/bash)
PWD | カレントディレクトリ

## <a id="environmentVariable"></a> 環境変数

シェルからは様々なコマンドを起動するが、このうち実行ファイルとしてファイルシステム上に存在するコマンドを **外部コマンド** といい、シェル自体に内蔵しているコマンドを **組み込みコマンド** という。  
あるコマンドが外部コマンドか組み込みコマンド化を判別するには、`type` コマンドが使える。

```shell
type set
set はシェル組み込み関数です

type cp
cp は /bin/cp です    # 外部コマンド
```

外部コマンドは、シェルの「外側」で実行されるため、現在のシェル変数の値を通常は参照することができない (シェル変数はシェル内部で保持されているため) 。  
これでは不便なので、**外部コマンドからも値を参照できるようにした変数を環境変数という**

例 : `cat --help` によるメッセージは、環境変数 `LANG` を参照して、指定のロケールに応じた言語で表示を行う。

`printenv` コマンドで、現在シェルに設定されている環境変数を表示できる。

## <a id="bashSettingFiles"></a> bash の設定ファイル

bash がログインシェルとして設定されている場合は、以下の順で読み込まれる。

1. /etc/profile

	システム全体で使用する設定ファイル。  
	全ユーザに共通する設定を記述する。  
	(通常はディストリビューション毎に適切な設定があらかじめ書かれているので、特に修正する必要はない)

1. ~/.bash_profile

	各ユーザ個別の設定ファイル。  
	`~/.bashrc` を読み込む設定が書かれていることが多い。  
	ログインした時だけ読み込まれる。  
	ログイン時に一度だけ設定すれば良い項目は、ここに記述する。

1. ~/.bashrc

	bash を起動するたびに毎回読み込まれる。  
	`~/.bash_profile` で設定する項目以外の項目は、ここに記述する。  
	(実際には多くの設定は bash 起動の度に毎回設定が必要なため、ほとんどの設定はここに記述する)

非ログインシェルとして、`bash` コマンドで起動された場合は、`~/.bashrc` が設定ファイルとして読み込まれる。

### <a id="loadTheBashSettingFile"></a> 設定ファイルの読み込み

設定ファイルを編集して保存した後は、以下の方法で読み込む。

- ログアウトしてから、再ログインする (bash を再起動する)。

- source コマンドで設定ファイルを実行する。

### <a id="comment"></a> コメント

`#` から行末までがコメントとして扱われ、実行時に無視される。

